(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c360a51a"],{"5bbb":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));i("d3b7"),i("159b");function n(e,t){var i=[];return e.forEach((function(a){if(""===a.pid&&(a["icon"]="chart"),a.pid===t){var r=n(e,a.id);r.length&&(a["children"]=r),i.push(a)}})),i}},"6fea":function(e,t,i){},c23a:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dashboard-container"},[i("div",{staticClass:"app-container"},[i("ToolsBar",{attrs:{"right-txt":"添加权限"},on:{rightClick:e.addPermission}},[i("span",{attrs:{slot:"title"},slot:"title"})]),i("el-card",{staticStyle:{"margin-top":"10px"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.permisForm,"highlight-current-row":"",border:"","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"}}},[i("el-table-column",{attrs:{prop:"name",label:"名称"}}),i("el-table-column",{attrs:{align:"center",prop:"code",label:"标识"}}),i("el-table-column",{attrs:{align:"center",prop:"description",label:"描述"}}),i("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["0"===n.pid?i("div",e._l(e.btnName,(function(t,a){return i("OperationModel",{key:a,attrs:{data:n,"btn-data":t},on:{activeEdit:e.activeEdit,activeAdd:e.activeAdd,reRander:e.reRander}})})),1):i("div",e._l(e.btnNameNoAdd,(function(t,a){return i("OperationModel",{key:a,attrs:{data:n,"btn-data":t},on:{activeEdit:e.activeEdit,activeAdd:e.activeAdd,reRander:e.reRander}})})),1)]}}])})],1)],1)],1),i("PermissionDialog",{attrs:{data:e.detailInfo,type:e.type,show:e.show,permission:e.permission,pid:e.pid},on:{"update:show":function(t){e.show=t},reRander:e.reRander}})],1)},a=[],r=i("c7eb"),s=i("1da1"),c=i("b775"),o=function(){return Object(c["a"])({url:"/sys/permission"})},d=function(e){return Object(c["a"])({url:"/sys/permission/".concat(e)})},l=function(e){return Object(c["a"])({url:"/sys/permission",method:"POST",data:e})},u=function(e){return Object(c["a"])({url:"/sys/permission/".concat(e.id),method:"PUT",data:e})},p=function(e){return Object(c["a"])({url:"/sys/permission/".concat(e),method:"DELETE"})},f=i("5bbb"),m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-button",{attrs:{type:"text"},on:{click:e.click}},[e._v(e._s(e.btnData.name))])},h=[],b=(i("c740"),i("4b2e")),v={props:{btnData:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}}},data:function(){return{}},created:function(){},methods:{click:function(){var e=this.data,t=this.btnData.type;"delete"===t?this.deleteBtn(e):"edit"===t?this.$emit("activeEdit",e.id):"add"===t&&this.$emit("activeAdd",e.id)},deleteBtn:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function i(){return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.$confirm("确认删除该权限点？","删除权限");case 3:if(t.verifyCode(e)){i.next=5;break}return i.abrupt("return",t.$message.error("当前数据为重要权限，禁止删除！"));case 5:return i.next=7,p(e.id);case 7:t.$emit("reRander"),t.$message.success("权限删除成功!"),i.next=14;break;case 11:i.prev=11,i.t0=i["catch"](0),console.log(i.t0);case 14:case"end":return i.stop()}}),i,null,[[0,11]])})))()},verifyCode:function(e){if("/"+e.code==="/import")return!0;var t=b["a"].findIndex((function(t){return t.path==="/"+e.code}));return-1===t}}},y=v,w=i("2877"),g=Object(w["a"])(y,m,h,!1,null,"c13a9756",null),x=g.exports,O=[{name:"添加",type:"add"},{name:"编辑",type:"edit"},{name:"删除",type:"delete"}],j=[{name:"编辑",type:"edit"},{name:"删除",type:"delete"}],k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:e.dialogName,visible:e.dialogShow,"destroy-on-close":""},on:{"update:visible":function(t){e.dialogShow=t},close:function(t){return e.$emit("update:show",!1)}}},[i("el-form",{ref:"form",attrs:{model:e.detailList,rules:e.dataRule,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"权限名称",prop:"name"}},[i("el-input",{model:{value:e.detailList.name,callback:function(t){e.$set(e.detailList,"name",t)},expression:"detailList.name"}})],1),i("el-form-item",{attrs:{label:"权限标识",prop:"code"}},[i("el-input",{model:{value:e.detailList.code,callback:function(t){e.$set(e.detailList,"code",t)},expression:"detailList.code"}})],1),i("el-form-item",{attrs:{label:"权限描述"}},[i("el-input",{model:{value:e.detailList.description,callback:function(t){e.$set(e.detailList,"description",t)},expression:"detailList.description"}})],1),i("el-form-item",{attrs:{label:"开启"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.detailList.enVisible,callback:function(t){e.$set(e.detailList,"enVisible",t)},expression:"detailList.enVisible"}})],1),i("el-form-item",[i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("确定")]),i("el-button",{on:{click:function(t){return e.$emit("update:show",!1)}}},[e._v("取消")])],1)],1)],1)],1)],1)},L=[],$=i("5530"),E=(i("d3b7"),i("4de4"),i("b0c0"),{props:{data:{type:Object,default:function(){return{}}},permission:{type:Array,default:function(){return{}}},type:{type:String,default:""},show:{type:Boolean,default:!1},pid:{type:String,default:""}},data:function(){return{detailList:{},dialogName:"弹窗",dataRule:{name:[{required:!0,trigger:"blur",message:"请填入权限名称"},{validator:this.verifyName,trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"请填入权限标识"},{validator:this.verifyCode,trigger:"blur"}]}}},computed:{dialogShow:{set:function(e){},get:function(){return this.show}}},watch:{type:function(){this.layData()},data:function(){this.layData()}},methods:{layData:function(){"edit"===this.type?(this.dialogName="编辑权限",this.detailList=Object($["a"])({},this.data)):"add"===this.type&&(this.dialogName="新增权限",this.detailList={},this.detailList.pid=this.pid)},verifyName:function(e,t,i){var n=this,a=!1;"add"===this.type?a=this.permission.filter((function(e){return e.pid===n.detailList.pid})).every((function(e){return e.name!==t})):"edit"===this.type&&(this.verify()||i(new Error("当前数据为重要权限，禁止修改!")),a=this.permission.filter((function(e){return e.id!==n.detailList.id&&e.pid===n.detailList.pid})).every((function(e){return e.name!==t}))),a?i():i(new Error("当前名称已存在于同部门中，请重新修改!"))},verifyCode:function(e,t,i){var n=this,a=!1;"add"===this.type?a=this.permission.every((function(e){return e.code!==t})):"edit"===this.type&&(this.verify()||i(new Error("当前数据为重要权限，禁止修改!")),a=this.permission.filter((function(e){return e.id!==n.detailList.id})).every((function(e){return e.code!==t}))),a?i():i(new Error("当前标识已存在，请重新修改!"))},verify:function(){var e=this;if("/"+this.data.code==="/import")return!0;var t=b["a"].findIndex((function(t){return t.path==="/"+e.data.code}));return-1===t},saveData:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.form.validate().then(Object(s["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("edit"!==e.type){t.next=6;break}return t.next=3,u(e.detailList);case 3:e.$message.success("权限修改成功!"),t.next=11;break;case 6:if("add"!==e.type){t.next=11;break}return e.detailList.type="0"===e.detailList.pid?1:2,t.next=10,l(e.detailList);case 10:e.$message.success("权限添加成功!");case 11:e.$emit("update:show",!1),e.detailList={},e.$emit("reRander");case 14:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t)})))()}}}),A=E,_=(i("e35f"),Object(w["a"])(A,k,L,!1,null,"1a803352",null)),N=_.exports,D={components:{OperationModel:x,PermissionDialog:N},data:function(){return{permisForm:[],btnName:O,btnNameNoAdd:j,detailInfo:{},type:"",show:!1,permission:[],pid:"",rander:!0}},created:function(){this.getAllPermission()},methods:{addPermission:function(){this.activeAdd(),this.pid="0"},getAllPermission:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o();case 2:i=t.sent,e.permisForm=Object(f["a"])(i,"0");case 4:case"end":return t.stop()}}),t)})))()},activeEdit:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function i(){return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,d(e);case 2:return t.detailInfo=i.sent,i.next=5,o();case 5:t.permission=i.sent,t.show=!0,t.type="edit";case 8:case"end":return i.stop()}}),i)})))()},activeAdd:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function i(){var n;return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!e){i.next=5;break}return i.next=3,d(e);case 3:n=i.sent,t.pid=n.id;case 5:t.show=!0,t.type="add";case 7:case"end":return i.stop()}}),i)})))()},reRander:function(){this.getAllPermission()}}},R=D,C=Object(w["a"])(R,n,a,!1,null,"f4017b64",null);t["default"]=C.exports},e35f:function(e,t,i){"use strict";i("6fea")}}]);