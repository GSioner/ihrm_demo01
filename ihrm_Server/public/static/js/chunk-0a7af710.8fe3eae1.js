(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a7af710"],{"0b62":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"dashboard-container"},[r("div",{staticClass:"app-container"},[r("ToolsBar",{attrs:{txt:t.txt},scopedSlots:t._u([{key:"button",fn:function(){return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.jsonToMultiExcel([],[])}}},[t._v("普通excel导出")]),r("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(e){return t.jsonToMultiExcel()}}},[t._v("复杂表头excel导出")]),r("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.$router.push("/import")}}},[t._v("excel导入")]),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.addStaffShow=!0}}},[t._v("新增员工")])]},proxy:!0}])}),r("StaffTable",{attrs:{txt:t.txt,total:t.total},on:{"update:txt":function(e){t.txt=e},"update:total":function(e){t.total=e}}})],1),r("AddStaff",{attrs:{show:t.addStaffShow,"add-staff-show":t.addStaffShow},on:{"update:addStaffShow":function(e){t.addStaffShow=e},"update:add-staff-show":function(e){t.addStaffShow=e}}})],1)},a=[],o=r("c7eb"),c=r("1da1"),i=(r("d3b7"),r("159b"),r("07ac"),r("d81d"),r("b64b"),r("3ca3"),r("ddb0"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"staff"}},[t.rander?r("el-card",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"80",sortable:""}}),r("el-table-column",{attrs:{prop:"username",label:"姓名",width:"160",sortable:""}}),r("el-table-column",{attrs:{align:"center",label:"头像","min-width":""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("img",{directives:[{name:"imgerror",rawName:"v-imgerror",value:t.errImg,expression:"errImg"}],staticClass:"img",attrs:{src:e.row.staffPhoto},on:{click:function(r){return t.showQrCode(e.row.staffPhoto)}}})]}}],null,!1,4141141628)}),r("el-table-column",{attrs:{prop:"mobile",label:"手机号","min-width":"",sortable:""}}),r("el-table-column",{attrs:{prop:"workNumber",label:"工号","min-width":"",sortable:""}}),r("el-table-column",{attrs:{prop:"formOfEmployment",label:"聘用形式","min-width":"",sortable:"",formatter:t.formatFormOfEmployment}}),r("el-table-column",{attrs:{prop:"departmentName",label:"部门","min-width":"",sortable:""}}),r("el-table-column",{attrs:{prop:"timeOfEntry",label:"入职时间","min-width":"",sortable:"",formatter:t.formatTimeOfEntry}}),r("el-table-column",{attrs:{prop:"enableState",label:"状态","min-width":"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-switch",{attrs:{disabled:""},model:{value:e.row.enableState,callback:function(r){t.$set(e.row,"enableState",r)},expression:"scope.row.enableState"}})]}}],null,!1,1460304897)}),r("el-table-column",{attrs:{label:"操作",width:"280",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClick(e.row,"check")}}},[t._v("查看")]),r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClick(e.row,"regular")}}},[t._v("转正")]),r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClick(e.row,"transfer")}}},[t._v("调岗")]),r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClick(e.row,"leave")}}},[t._v("离职")]),r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClick(e.row,"role")}}},[t._v("角色")]),r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClick(e.row,"delete")}}},[t._v("删除")])]}}],null,!1,3936393363)})],1),r("div",{staticClass:"pageModel"},[r("span",{staticClass:"demonstration"},[t._v("共 "+t._s(t.page.total)+" 条")]),r("el-pagination",{attrs:{layout:"prev, pager, next",total:t.page.total,"page-size":t.page.size,"current-page":t.page.page},on:{"current-change":t.handleCurrentChange}})],1)],1):t._e(),r("el-dialog",{attrs:{visible:t.qecodeShow,title:"二维码"},on:{"update:visible":function(e){t.qecodeShow=e}}},[r("el-row",{attrs:{type:"flex",justify:"center"}},[r("canvas",{ref:"myQrCode"})])],1),r("el-dialog",{attrs:{visible:t.roleShow,title:"分配角色"},on:{"update:visible":function(e){t.roleShow=e},close:function(e){t.checkList=[]}}},[r("el-row",{attrs:{type:"flex",align:"center"}},t._l(t.roleList,(function(e){return r("el-checkbox",{key:e.name,attrs:{label:e.id},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[t._v(t._s(e.name))])})),1),r("el-row",{attrs:{type:"flex",justify:"center"}},[r("span",{staticClass:"dialog-footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.saveRole}},[t._v("确 定")]),r("el-button",{on:{click:function(e){t.roleShow=!1}}},[t._v("取 消")])],1)])],1)],1)}),l=[],s=(r("fb6a"),r("7db0"),r("b0c0"),r("5a0c")),u=r.n(s),f={formOfEmployment:[{id:1,name:"正式"},{id:2,name:"非正式"}],timeOfEntry:function(t){return u()(t).format("YYYY-MM-DD")}},m=r("8f00"),d=r("90e7"),b=r("d055"),p=r.n(b),h={data:function(){return{tableData:[],page:{page:+localStorage.getItem("page")||1,size:10,total:10},errImg:r("ed7b"),rander:!0,qecodeShow:!1,roleShow:!1,checkList:[],roleList:[],uid:""}},created:function(){this.getStaffInfo(),this.getRoleInfo()},methods:{handleClick:function(t,e){var r=this;return Object(c["a"])(Object(o["a"])().mark((function n(){var a,c,i;return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("delete"!==e){n.next=15;break}return n.prev=1,n.next=4,r.$confirm("确认删除该用户？");case 4:return n.next=6,Object(m["e"])(t.id);case 6:r.$message.success("删除成功！"),r.reRander(),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](1),r.$message.info("已取消删除");case 13:n.next=29;break;case 15:if("check"!==e){n.next=20;break}r.$router.push("/employees/detail/".concat(t.id)),localStorage.setItem("staffImg",t.staffPhoto),n.next=29;break;case 20:if("role"!==e){n.next=29;break}return n.next=23,Object(m["i"])(t.id);case 23:a=n.sent,c=a.roleIds,i=Object.prototype.toString.call(c).slice(8,-1),"Object"===i?r.checkList=c.map((function(t){return t.id})):"Array"===i&&(r.checkList=c),r.uid=t.id,r.roleShow=!0;case 29:case"end":return n.stop()}}),n,null,[[1,10]])})))()},getStaffInfo:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){var r,n;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["h"])(t.page);case 2:r=e.sent,t.page.total=r.total,t.timeFormData(r.rows),t.tableData=r.rows,n="共 ".concat(r.total," 条数据"),t.$emit("update:txt",n),t.$emit("update:total",r.total);case 9:case"end":return e.stop()}}),e)})))()},handleCurrentChange:function(t){this.page.page=t,this.getStaffInfo(),localStorage.setItem("page",t)},timeFormData:function(t){t.forEach((function(t){t.enableState=1===t.enableState}))},reRander:function(){var t=this;this.rander=!1,setTimeout((function(){return t.rander=!0}),0)},formatFormOfEmployment:function(t,e,r,n){var a=f.formOfEmployment.find((function(t){return t.id===r}));return a?a.name:"未知"},formatTimeOfEntry:function(t,e,r,n){return f.timeOfEntry(r)},showQrCode:function(t){var e=this;t?(this.qecodeShow=!0,this.$nextTick((function(){return p.a.toCanvas(e.$refs["myQrCode"],t)}))):this.$notify({type:"warning",duration:1e3,message:"该用户未上传头像，当前使用的为默认头像!"})},saveRole:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){var r;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={id:t.uid,roleIds:[]},t.checkList.length&&Array.isArray(t.checkList)?(r.roleIds=t.checkList,t.$message.success("员工角色分配成功")):(t.$message.warning("数据异常，将重置当前角色数据"),t.checkList=[]),e.next=4,Object(m["c"])(r);case 4:t.roleShow=!1;case 5:case"end":return e.stop()}}),e)})))()},getRoleInfo:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){var r,n;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["f"])({page:1,pagesize:100});case 2:r=e.sent,n=r.rows,t.roleList=n;case 5:case"end":return e.stop()}}),e)})))()}}},g=h,w=(r("8e45"),r("2877")),y=Object(w["a"])(g,i,l,!1,null,"4784929a",null),O=y.exports,v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:"收货地址",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[r("el-form",{ref:"formData",attrs:{model:t.form,"label-width":"120px",rules:t.rules}},[r("el-form-item",{attrs:{label:"姓名",prop:"username"}},[r("el-input",{staticClass:"input",attrs:{placeholder:"请输入姓名"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{staticClass:"input",attrs:{placeholder:"请输入手机号"},model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1),r("el-form-item",{attrs:{label:"入职时间",prop:"timeOfEntry"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"请选择入职时间"},model:{value:t.form.timeOfEntry,callback:function(e){t.$set(t.form,"timeOfEntry",e)},expression:"form.timeOfEntry"}})],1),r("el-form-item",{attrs:{label:"聘用形式",prop:"formOfEmployment"}},[r("el-select",{attrs:{placeholder:"请选择聘用形式"},model:{value:t.form.formOfEmployment,callback:function(e){t.$set(t.form,"formOfEmployment",e)},expression:"form.formOfEmployment"}},[r("el-option",{attrs:{label:"正式",value:"1"}}),r("el-option",{attrs:{label:"非正式",value:"2"}})],1)],1),r("el-form-item",{attrs:{label:"工号",prop:"workNumber"}},[r("el-input",{staticClass:"input",attrs:{placeholder:"请输入工号"},model:{value:t.form.workNumber,callback:function(e){t.$set(t.form,"workNumber",e)},expression:"form.workNumber"}})],1),r("el-form-item",{attrs:{label:"部门",prop:"departmentName"}},[r("el-input",{staticClass:"input",attrs:{placeholder:"请选择部门"},nativeOn:{click:function(e){return t.showTree(e)}},model:{value:t.form.departmentName,callback:function(e){t.$set(t.form,"departmentName",e)},expression:"form.departmentName"}}),t.tree?r("el-tree",{attrs:{data:t.data,props:t.defaultProps,"default-expand-all":!0},on:{"node-click":t.handleNodeClick}}):t._e()],1),r("el-form-item",{attrs:{label:"转正时间"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"请选择转正时间"},model:{value:t.form.correctionTime,callback:function(e){t.$set(t.form,"correctionTime",e)},expression:"form.correctionTime"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.changeShow(1)}}},[t._v("确 定")]),r("el-button",{on:{click:function(e){return t.changeShow(0)}}},[t._v("取 消")])],1)],1)},k=[],j=r("fcac"),x=r("5bbb"),S={props:{show:{type:Boolean,default:!1}},data:function(){return{tree:!1,dialogFormVisible:!1,form:{username:"",mobile:"",formOfEmployment:"",workNumber:"",departmentName:"",timeOfEntry:"",correctionTime:""},rules:{username:[{required:!0,trigger:"blur",message:"请输入姓名"},{min:1,max:4,trigger:"blur",message:"请输入1-4个字符"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,trigger:"blur",message:"请输入正确的手机号格式"}],formOfEmployment:[{required:!0,trigger:"blur",message:"请选择聘用形式"}],workNumber:[{required:!0,trigger:"blur",message:"请输入工号"}],departmentName:[{required:!0,trigger:"change",message:"请输入部门名称"},{validator:this.validateCompany,trigger:"change"}],timeOfEntry:[{required:!0,trigger:"blur",message:"请输入入职时间"}]},data:[],defaultProps:{children:"children",label:"name"}}},watch:{show:function(){this.dialogFormVisible=this.show}},created:function(){this.getCompanyDeparts()},methods:{changeShow:function(t){var e=this;t?this.$refs["formData"].validate(function(){var t=Object(c["a"])(Object(o["a"])().mark((function t(r){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=8;break}return e.editData(e.form),t.next=4,Object(m["b"])(e.form);case 4:e.$emit("update:addStaffShow",!1),e.$message.success("员工新增成功"),t.next=9;break;case 8:return t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.$emit("update:addStaffShow",!1)},editData:function(t){t.correctionTime=u()(t.correctionTime).form("YYYY-MM-DD"),t.timeOfEntry=u()(t.timeOfEntry).form("YYYY-MM-DD"),t.formOfEmployment=+t.formOfEmployment,t.mobile=+t.mobile,t.workNumber=+t.workNumber},getCompanyDeparts:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){var r,n;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(j["d"])();case 2:r=e.sent,n=r.depts,t.data=Object(x["a"])(n,"");case 5:case"end":return e.stop()}}),e)})))()},handleNodeClick:function(t){this.form.departmentName=t.name,this.tree=!1},showTree:function(){this.getCompanyDeparts(),this.tree=!0},validateCompany:function(t,e,r){return Object(c["a"])(Object(o["a"])().mark((function t(){var n,a,c;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(j["d"])();case 2:n=t.sent,a=n.depts,c=a.some((function(t){return t.name===e})),c?r():r(new Error("请选择正确的部门名称!"));case 6:case"end":return t.stop()}}),t)})))()}}},E=S,C=(r("9ff8"),Object(w["a"])(E,v,k,!1,null,"5a71df99",null)),T=C.exports,_={components:{StaffTable:O,AddStaff:T},data:function(){return{txt:"暂无数据",addStaffShow:!1,tableData:[],total:10}},watch:{total:function(){this.getData()}},methods:{getData:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["h"])({page:1,size:50});case 2:t.tableData=e.sent,t.tableData["rows"].forEach((function(t){t.correctionTime=f.timeOfEntry(t.correctionTime),t.timeOfEntry=f.timeOfEntry(t.timeOfEntry)}));case 4:case"end":return e.stop()}}),e)})))()},jsonToMultiExcel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={username:"姓名",id:"员工ID",mobile:"手机号",password:"密码",enableState:"账户状态",timeOfEntry:"入职日期",formOfEmployment:"聘用形式",workNumber:"工号",correctionTime:"转正日期",staffPhoto:"头像",departmentName:"部门"},a={filename:"员工信息表"};a.multiHeader=t||[["姓名","主要信息","","","","","","","","","部门"]],a.merges=e||["A1:A2","B1:J1","K1:K2"],a.header=Object.values(n),a.data=this.tableData["rows"].map((function(t){return t["enableState"]=t["enableState"]?"激活":"未激活",1===+t["formOfEmployment"]?t["formOfEmployment"]="正式":2===+t["formOfEmployment"]&&(t["formOfEmployment"]="非正式"),Object.keys(n).map((function(e){return t[e]}))})),Promise.all([r.e("chunk-519483dc"),r.e("chunk-149ee2f6")]).then(r.bind(null,"4bf8")).then((function(t){return t.export_json_to_excel(a)}))}}},$=_,D=(r("17be"),Object(w["a"])($,n,a,!1,null,"6c9d7c64",null));e["default"]=D.exports},"17be":function(t,e,r){"use strict";r("b3b4")},"5bbb":function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r("d3b7"),r("159b");function n(t,e){var r=[];return t.forEach((function(a){if(""===a.pid&&(a["icon"]="chart"),a.pid===e){var o=n(t,a.id);o.length&&(a["children"]=o),r.push(a)}})),r}},"8e45":function(t,e,r){"use strict";r("aabf")},"8f00":function(t,e,r){"use strict";r.d(e,"h",(function(){return a})),r.d(e,"e",(function(){return o})),r.d(e,"b",(function(){return c})),r.d(e,"a",(function(){return i})),r.d(e,"d",(function(){return l})),r.d(e,"i",(function(){return s})),r.d(e,"l",(function(){return u})),r.d(e,"f",(function(){return f})),r.d(e,"k",(function(){return m})),r.d(e,"j",(function(){return d})),r.d(e,"g",(function(){return b})),r.d(e,"c",(function(){return p}));var n=r("b775"),a=function(t){return Object(n["a"])({url:"/sys/user",params:t})},o=function(t){return Object(n["a"])({url:"/sys/user/".concat(t)})},c=function(t){return Object(n["a"])({url:"/sys/user",method:"POST",data:t})},i=function(t){return Object(n["a"])({url:"/sys/user",method:"POST",data:t})},l=function(t){return Object(n["a"])({url:"/sys/user/batch",method:"POST",data:t})},s=function(t){return Object(n["a"])({url:"/sys/user/".concat(t)})},u=function(){return Object(n["a"])({url:"/sys/user/simple"})},f=function(t,e){return Object(n["a"])({url:"/sys/user/".concat(t),method:"PUT",data:e})},m=function(t){return Object(n["a"])({url:"/employees/".concat(t,"/personalInfo")})},d=function(t){return Object(n["a"])({url:"/employees/".concat(t,"/jobs")})},b=function(t,e){return Object(n["a"])({url:"/employees/".concat(t,"/jobs"),method:"PUT",data:e})},p=function(t){return Object(n["a"])({url:"/sys/user/assignRoles",method:"PUT",data:t})}},"90e7":function(t,e,r){"use strict";r.d(e,"d",(function(){return a})),r.d(e,"f",(function(){return o})),r.d(e,"e",(function(){return c})),r.d(e,"g",(function(){return i})),r.d(e,"h",(function(){return l})),r.d(e,"c",(function(){return s})),r.d(e,"b",(function(){return u})),r.d(e,"a",(function(){return f}));var n=r("b775"),a=function(){return Object(n["a"])({url:"/company"})},o=function(t){return Object(n["a"])({url:"/sys/role",params:t})},c=function(){return Object(n["a"])({url:"/sys/permission"})},i=function(t){return Object(n["a"])({url:"/sys/role/".concat(t)})},l=function(t){return Object(n["a"])({url:"/sys/role/assignPrem",method:"PUT",data:t})},s=function(t,e){return Object(n["a"])({url:"/sys/role/".concat(e),method:"PUT",data:t})},u=function(t){return Object(n["a"])({url:"/sys/role/".concat(t),method:"DELETE"})},f=function(t){return Object(n["a"])({url:"/sys/role",method:"POST",data:t})}},"9ff8":function(t,e,r){"use strict";r("ecc5")},aabf:function(t,e,r){},b3b4:function(t,e,r){},ecc5:function(t,e,r){},ed7b:function(t,e,r){t.exports=r.p+"static/img/head.b6c3427d.jpg"},fcac:function(t,e,r){"use strict";r.d(e,"d",(function(){return a})),r.d(e,"f",(function(){return o})),r.d(e,"b",(function(){return c})),r.d(e,"a",(function(){return i})),r.d(e,"c",(function(){return l})),r.d(e,"e",(function(){return s}));var n=r("b775"),a=function(){return Object(n["a"])({url:"/company/department"})},o=function(){return Object(n["a"])({url:"/sys/user/simple"})},c=function(t){return Object(n["a"])({url:"/company/department/".concat(t),method:"DELETE"})},i=function(t){return Object(n["a"])({url:"/company/department",method:"POST",data:t})},l=function(t){return Object(n["a"])({url:"/company/department",method:"PUT",data:t})},s=function(t){return Object(n["a"])({url:"/company/department/".concat(t)})}}}]);